% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pls_fit.R
\name{pls_fit}
\alias{pls_fit}
\title{Unified PLS fit with auto backend}
\usage{
pls_fit(
  X,
  y,
  ncomp,
  tol = 1e-08,
  backend = c("auto", "arma", "bigmem"),
  scores = c("none", "r", "big"),
  chunk_size = 10000L,
  scores_name = "scores",
  mode = c("auto", "pls1", "pls2"),
  scores_target = c("auto", "new", "existing"),
  scores_bm = NULL,
  scores_backingfile = NULL,
  scores_backingpath = NULL,
  scores_descriptorfile = NULL,
  scores_colnames = NULL,
  return_scores_descriptor = FALSE
)
}
\arguments{
\item{X}{numeric matrix or \code{bigmemory::big.matrix}}

\item{y}{numeric vector or single-column \code{big.matrix}}

\item{ncomp}{number of latent components}

\item{tol}{numeric tolerance used in the core solver}

\item{backend}{one of \code{"auto"}, \code{"arma"}, \code{"bigmem"}}

\item{scores}{one of \code{"none"}, \code{"r"}, \code{"big"}}

\item{chunk_size}{chunk size for the bigmem backend}

\item{scores_name}{name for the scores big.matrix (when \code{scores="big"})}
}
\value{
a list with coefficients, intercept, weights, loadings, means,
and optionally \code{$scores}.
}
\description{
Dispatches to a dense (Arm/BLAS) backend for in-memory matrices
or to a streaming big.matrix backend when X (or Y) is a big.matrix.
}
\examples{
set.seed(1)
X <- matrix(rnorm(200*50), 200, 50)
y <- X[,1]*2 - X[,2] + rnorm(200)
bmX <- bigmemory::as.big.matrix(X)
bmy <- bigmemory::as.big.matrix(matrix(y, nrow(X), 1))
sink_bm <- bigmemory::filebacked.big.matrix(
  nrow = nrow(bmX), ncol = 3, type = "double",
  backingfile = "scores.bin", backingpath = tempdir(),
  descriptorfile = "scores.desc"
)

fit <- pls_fit(bmX, bmy, ncomp = 3, backend = "bigmem", scores = "big",
              scores_target = "existing", scores_bm = sink_bm)

Dense, named scores (no descriptor here; scores are base matrix)
fit1 <- pls_fit(X, y, ncomp = 3,
                backend = "arma", scores = "r",
                scores_colnames = c("t1","t2","t3"),
                return_scores_descriptor = TRUE)
colnames(fit1$scores)              # "t1" "t2" "t3"
"scores_descriptor" \%in\% names(fit1)  # FALSE (dense scores aren't big.matrix)

# Big-matrix with external file-backed sink, named + descriptor
sink_bm <- bigmemory::filebacked.big.matrix(
  nrow=nrow(bmX), ncol=3, type="double",
  backingfile="scores.bin", backingpath=tempdir(),
  descriptorfile="scores.desc"
)
fit2 <- pls_fit(bmX, bmy, ncomp = 3,
                backend = "bigmem", scores = "big",
                scores_target = "existing", scores_bm = sink_bm,
                scores_colnames = c("t1","t2","t3"),
                return_scores_descriptor = TRUE)
colnames(fit2$scores)               # "t1" "t2" "t3"
fit2$scores_descriptor              # big.matrix.descriptor


}
